# WcfAuto å®¢æˆ·ç«¯ï¼ˆåŸºäº python å®¢æˆ·ç«¯ï¼‰
[![PyPi](https://img.shields.io/pypi/v/wcferry.svg)](https://pypi.python.org/pypi/wcferry) [![Downloads](https://static.pepy.tech/badge/wcferry)](https://pypi.python.org/pypi/wcferry) [![Documentation Status](https://readthedocs.org/projects/wechatferry/badge/?version=latest)](https://wechatferry.readthedocs.io/zh/latest/?badge=latest)

|[ğŸ“– æ–‡æ¡£](https://wechatferry.readthedocs.io/)|[ğŸ“º è§†é¢‘æ•™ç¨‹](https://mp.weixin.qq.com/s/APdjGyZ2hllXxyG_sNCfXQ)|[ğŸ™‹ FAQ](https://mp.weixin.qq.com/s/vAGpn1C9stI8Xzt1hUJhLA)|
|:-:|:-:|:-:|

ğŸ¤–ç¤ºä¾‹æœºå™¨äººæ¡†æ¶ï¼š[WeChatRobot](https://github.com/lich0821/WeChatRobot)ã€‚

## å¿«é€Ÿå¼€å§‹
```sh
pip install --upgrade wcfauto
```

### Demoï¼š
```py
#! /usr/bin/env python3
# -*- coding: utf-8 -*-

import logging
from time import sleep
from wcfauto import Register, Wcf, WxMsg

logging.basicConfig(level='DEBUG', format="%(asctime)s %(message)s")
LOG = logging.getLogger("Demo")


def main():
    receiver = Register()

    @receiver.message_register(isDivision=True, isGroup=True, isPyq=False)
    def process_msg(bot: Wcf, msg: WxMsg):
        """
        åŒæ­¥æ¶ˆæ¯å‡½æ•°è£…é¥°å™¨
        """
        LOG.info(f"æ”¶åˆ°æ¶ˆæ¯: {msg}")

        sleep(5)  # ç­‰å¾®ä¿¡åŠ è½½å¥½ï¼Œä»¥å…ä¿¡æ¯æ˜¾ç¤ºå¼‚å¸¸
        LOG.info(f"å·²ç»ç™»å½•: {True if bot.is_login() else False}")
        LOG.info(f"wxid: {bot.get_self_wxid()}")

        # bot.disable_recv_msg() # å½“éœ€è¦åœæ­¢æ¥æ”¶æ¶ˆæ¯æ—¶è°ƒç”¨
        sleep(5)
        ret = bot.send_text("Hello world.", "filehelper")
        LOG.info(f"send_text: {ret}")

        sleep(5)
        # éœ€è¦ç¡®ä¿å›¾ç‰‡è·¯å¾„æ­£ç¡®ï¼Œå»ºè®®ä½¿ç”¨ç»å¯¹è·¯å¾„ï¼ˆä½¿ç”¨åŒæ–œæ \\ï¼‰
        ret = bot.send_image(
            "https://raw.githubusercontent.com/lich0821/WeChatFerry/master/assets/QR.jpeg", "filehelper")
        LOG.info(f"send_image: {ret}")

        sleep(5)
        # éœ€è¦ç¡®ä¿æ–‡ä»¶è·¯å¾„æ­£ç¡®ï¼Œå»ºè®®ä½¿ç”¨ç»å¯¹è·¯å¾„ï¼ˆä½¿ç”¨åŒæ–œæ \\ï¼‰
        ret = bot.send_file("https://raw.githubusercontent.com/lich0821/WeChatFerry/master/README.MD", "filehelper")
        LOG.info(f"send_file: {ret}")

        sleep(5)
        LOG.info(f"Message types:\n{bot.get_msg_types()}")
        LOG.info(f"Contacts:\n{bot.get_contacts()}")

        sleep(5)
        LOG.info(f"DBs:\n{bot.get_dbs()}")
        LOG.info(f"Tables:\n{bot.get_tables('db')}")
        LOG.info(f"Results:\n{bot.query_sql('MicroMsg.db', 'SELECT * FROM Contact LIMIT 1;')}")

        # éœ€è¦çœŸæ­£çš„ V3ã€V4 ä¿¡æ¯
        # bot.accept_new_friend("v3", "v4")

        # æ·»åŠ ç¾¤æˆå‘˜ï¼Œå¡«å†™æ­£ç¡®çš„ç¾¤ ID å’Œæˆå‘˜ wxid
        # ret = bot.add_chatroom_members("chatroom id", "wxid1,wxid2,wxid3,...")
        # LOG.info(f"add_chatroom_members: {ret}")

        # åˆ é™¤ç¾¤æˆå‘˜ï¼Œå¡«å†™æ­£ç¡®çš„ç¾¤ ID å’Œæˆå‘˜ wxid
        # ret = bot.del_chatroom_members("chatroom id", "wxid1,wxid2,wxid3,...")
        # LOG.info(f"add_chatroom_members: {ret}")

        sleep(5)
        bot.refresh_pyq(0)  # åˆ·æ–°æœ‹å‹åœˆç¬¬ä¸€é¡µ
        # bot.refresh_pyq(id)  # ä» id å¼€å§‹åˆ·æ–°æœ‹å‹åœˆ

    @receiver.async_message_register()
    async def async_process_msg(bot: Wcf, msg: WxMsg):
        """
        å¼‚æ­¥æ¶ˆæ¯å‡½æ•°è£…é¥°å™¨
        """
        print(msg)
    
    @receiver.group_changed_register(allow_other_receive=False)
    async def group_changed(bot: Wcf, msg: WxMsg):
        """
        ç¾¤ç»„ä¿¡æ¯å˜åŒ–å‡½æ•°è£…é¥°å™¨
        """
        print(msg)
        
    @receiver.revoke_message_register(allow_other_receive=False)
    async def group_changed(bot: Wcf, msg: WxMsg):
        """
        æ’¤å›æ¶ˆæ¯å‡½æ•°è£…é¥°å™¨
        """
        print(msg)
        print(msg.get_revoke_msg())
    
    def judge(msg: WxMsg):
        """
        æ¶ˆæ¯åˆ¤æ–­å‡½æ•°
        """
        return False
    
    
    @receiver.custom_message_register(register_name='custom', msg_judge_func=judge, allow_other_receive=False)
    async def group_changed(bot: Wcf, msg: WxMsg):
        """
        è‡ªå®šä¹‰æ¶ˆæ¯æ¥æ”¶å‡½æ•°è£…é¥°å™¨
        """
        print(msg)

    # å¼€å§‹æ¥å—æ¶ˆæ¯
    receiver.run()


if __name__ == "__main__":
    main()


```

|![ç¢²çŸ¿](https://raw.githubusercontent.com/lich0821/WeChatFerry/master/assets/TEQuant.jpg)|![èµèµ](https://raw.githubusercontent.com/lich0821/WeChatFerry/master/assets/QR.jpeg)|
|:-:|:-:|
|åå°å›å¤ `WCF` åŠ ç¾¤äº¤æµ|å¦‚æœä½ è§‰å¾—æœ‰ç”¨|
